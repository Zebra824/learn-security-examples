The secure version uses session to verify user's identity